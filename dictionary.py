data_dict = [{
    "code": "01",
    "name": "Засаг захиргааны нэгж",
    "children": [
      {
        "code": "01",
        "name": "нийслэл"
      },
      {
        "code": "04",
        "name": "сум"
      },
      {
        "code": "02",
        "name": "аймаг"
      },
      {
        "code": "05",
        "name": "хороо"
      },
      {
        "code": "03",
        "name": "дүүрэг"
      },
      {
        "code": "06",
        "name": "баг"
      }
    ]
  },
  {
    "code": "02",
    "name": "Суурьшил",
    "children": [
      {
        "code": "01",
        "name": "хот"
      },
      {
        "code": "06",
        "name": "өртөө"
      },
      {
        "code": "02",
        "name": "гудамж"
      },
      {
        "code": "07",
        "name": "бригад"
      },
      {
        "code": "03",
        "name": "талбай"
      },
      {
        "code": "08",
        "name": "тасаг"
      },
      {
        "code": "04",
        "name": "хороолол"
      },
      {
        "code": "09",
        "name": "ферм"
      },
      {
        "code": "05",
        "name": "хотхон"
      },
      {
        "code": "10",
        "name": "цех"
      }
    ]
  },
  {
    "code": "01",
    "name": "Түүхэн дурсгалт",
    "children": [
      {
        "code": "01",
        "name": "туурь"
      },
      {
        "code": "04",
        "name": "хиргисүүр, хирвэс"
      },
      {
        "code": "02",
        "name": "хөшөө"
      },
      {
        "code": "05",
        "name": "цайз хэрэм"
      },
      {
        "code": "03",
        "name": "балгас"
      }
    ]
  },
  {
    "code": "02",
    "name": "Барилга, байгууламж",
    "children": [
      {
        "code": "01",
        "name": "бууц"
      },
      {
        "code": "08",
        "name": "гүүр"
      },
      {
        "code": "02",
        "name": "далан"
      },
      {
        "code": "09",
        "name": "уурхай"
      },
      {
        "code": "03",
        "name": "өвөлжөө"
      },
      {
        "code": "10",
        "name": "суурь"
      },
      {
        "code": "04",
        "name": "шуудуу"
      },
      {
        "code": "11",
        "name": "хашаа"
      },
      {
        "code": "05",
        "name": "зам"
      },
      {
        "code": "12",
        "name": "хороо"
      },
      {
        "code": "06",
        "name": "өтөг"
      },
      {
        "code": "13",
        "name": "шан"
      },
      {
        "code": "07",
        "name": "байшин"
      }
    ]
  },
  {
    "code": "03",
    "name": "Шашин",
    "children": [
      {
        "code": "01",
        "name": "суварга"
      },
      {
        "code": "03",
        "name": "жас"
      },
      {
        "code": "02",
        "name": "сүм, дуган, хийд"
      }
    ]
  },
  {
    "code": "01",
    "name": "Уул",
    "children": [
      {
        "code": "01",
        "name": "аараг"
      },
      {
        "code": "22",
        "name": "суга"
      },
      {
        "code": "02",
        "name": "адарга"
      },
      {
        "code": "23",
        "name": "сэрвэн"
      },
      {
        "code": "03",
        "name": "ам"
      },
      {
        "code": "24",
        "name": "таг"
      },
      {
        "code": "04",
        "name": "асга"
      },
      {
        "code": "25",
        "name": "тайга"
      },
      {
        "code": "05",
        "name": "байц"
      },
      {
        "code": "26",
        "name": "толгод"
      },
      {
        "code": "06",
        "name": "богоч"
      },
      {
        "code": "27",
        "name": "толгой, болдог"
      },
      {
        "code": "07",
        "name": "бөөрөг"
      },
      {
        "code": "28",
        "name": "уул, хайрхан"
      },
      {
        "code": "08",
        "name": "бэл"
      },
      {
        "code": "29",
        "name": "ухаа"
      },
      {
        "code": "09",
        "name": "даваа, дав, онь"
      },
      {
        "code": "30",
        "name": "хавцал"
      },
      {
        "code": "10",
        "name": "дөрөлж"
      },
      {
        "code": "31",
        "name": "хамар, өвдөг, гэзэг"
      },
      {
        "code": "11",
        "name": "ёроол"
      },
      {
        "code": "32",
        "name": "хормой"
      },
      {
        "code": "12",
        "name": "зоо"
      },
      {
        "code": "33",
        "name": "хунх, хүнх"
      },
      {
        "code": "13",
        "name": "зураа"
      },
      {
        "code": "34",
        "name": "хүнхэр"
      },
      {
        "code": "14",
        "name": "зээг"
      },
      {
        "code": "35",
        "name": "хүр, хүрд"
      },
      {
        "code": "15",
        "name": "нуруу"
      },
      {
        "code": "36",
        "name": "хэц"
      },
      {
        "code": "16",
        "name": "овоо"
      },
      {
        "code": "37",
        "name": "хяр, хянга"
      },
      {
        "code": "17",
        "name": "орой, оргил, өндөрлөг, өндөр"
      },
      {
        "code": "38",
        "name": "хясаа"
      },
      {
        "code": "18",
        "name": "өвөр"
      },
      {
        "code": "39",
        "name": "цав"
      },
      {
        "code": "19",
        "name": "салаа"
      },
      {
        "code": "40",
        "name": "царам"
      },
      {
        "code": "20",
        "name": "сархиа, сархиаг, сархид"
      },
      {
        "code": "41",
        "name": "шил"
      },
      {
        "code": "21",
        "name": "сарьдаг"
      },
      {
        "code": "42",
        "name": "энгэр, ташуу, цалуу, нураг, нурган, нахиу"
      }
    ]
  },
  {
    "code": "02",
    "name": "Амьтан, ургамал",
    "children": [
      {
        "code": "01",
        "name": "айраг"
      },
      {
        "code": "10",
        "name": "түнгэ, ширэнгэ, шугай"
      },
      {
        "code": "02",
        "name": "бургас, бут, бударгана, булаа, арц, сондуул, торлог, хармаг, сухай"
      },
      {
        "code": "11",
        "name": "тэсэг"
      },
      {
        "code": "03",
        "name": "дэрс"
      },
      {
        "code": "12",
        "name": "улиас"
      },
      {
        "code": "04",
        "name": "заг"
      },
      {
        "code": "13",
        "name": "хаг"
      },
      {
        "code": "05",
        "name": "мод"
      },
      {
        "code": "14",
        "name": "хайлаас, хайлс"
      },
      {
        "code": "06",
        "name": "нарс"
      },
      {
        "code": "15",
        "name": "харгайт"
      },
      {
        "code": "07",
        "name": "нуга, ширэг, зүлэг, таана"
      },
      {
        "code": "16",
        "name": "харгана"
      },
      {
        "code": "08",
        "name": "ой, төгөл, хөвч"
      },
      {
        "code": "17",
        "name": "хулс"
      },
      {
        "code": "09",
        "name": "сөөг, шаваг, шарилж"
      },
      {
        "code": "18",
        "name": "хус, боролж"
      }
    ]
  },
  {
    "code": "03",
    "name": "Хөрс, чулуулаг",
    "children": [
      {
        "code": "01",
        "name": "марз, мараа"
      },
      {
        "code": "06",
        "name": "чулуу"
      },
      {
        "code": "02",
        "name": "намаг"
      },
      {
        "code": "07",
        "name": "шал, шавар, шалбааг, лах"
      },
      {
        "code": "03",
        "name": "сондог"
      },
      {
        "code": "08",
        "name": "элс, манхан"
      },
      {
        "code": "04",
        "name": "хайрга, дайрга"
      },
      {
        "code": "09",
        "name": "явар, цахир, цайдам, борзон"
      }
    ]
  },
  {
    "code": "03",
    "name": "Хөрс, чулуулаг",
    "children": [
      {
        "code": "01",
        "name": "марз, мараа"
      },
      {
        "code": "06",
        "name": "чулуу"
      },
      {
        "code": "02",
        "name": "намаг"
      },
      {
        "code": "07",
        "name": "шал, шавар, шалбааг, лах"
      },
      {
        "code": "03",
        "name": "сондог"
      },
      {
        "code": "08",
        "name": "элс, манхан"
      },
      {
        "code": "04",
        "name": "хайрга, дайрга"
      },
      {
        "code": "09",
        "name": "явар, цахир, цайдам, борзон"
      },
      {
        "code": "05",
        "name": "хаш, хүлэр, зэс, гяваат"
      }
    ]
  },
  {
    "code": "04",
    "name": "Ус зүй",
    "children": [
      {
        "code": "01",
        "name": "арал"
      },
      {
        "code": "13",
        "name": "суваг, судаг, татаал"
      },
      {
        "code": "02",
        "name": "боом"
      },
      {
        "code": "14",
        "name": "тавилан"
      },
      {
        "code": "03",
        "name": "булаг"
      },
      {
        "code": "15",
        "name": "татуурга"
      },
      {
        "code": "04",
        "name": "гарам, олом"
      },
      {
        "code": "16",
        "name": "тойром, цөөрөм"
      },
      {
        "code": "05",
        "name": "гатлага"
      },
      {
        "code": "17",
        "name": "тохой"
      },
      {
        "code": "06",
        "name": "гол, харз"
      },
      {
        "code": "18",
        "name": "ус"
      },
      {
        "code": "07",
        "name": "горхи"
      },
      {
        "code": "19",
        "name": "усан сан"
      },
      {
        "code": "08",
        "name": "мөрөн"
      },
      {
        "code": "20",
        "name": "хөвөө"
      },
      {
        "code": "09",
        "name": "нуур"
      },
      {
        "code": "21",
        "name": "худаг"
      },
      {
        "code": "10",
        "name": "рашaan"
      },
      {
        "code": "22",
        "name": "цутгалан, хүрхэрээ, таргил"
      }
    ]
  },
  {
    "code": "04",
    "name": "Ус зүй",
    "children": [
      {
        "code": "01",
        "name": "арал"
      },
      {
        "code": "13",
        "name": "суваг, судаг, татаал"
      },
      {
        "code": "02",
        "name": "боом"
      },
      {
        "code": "14",
        "name": "тавилан"
      },
      {
        "code": "03",
        "name": "булаг"
      },
      {
        "code": "15",
        "name": "татуурга"
      },
      {
        "code": "04",
        "name": "гарам, олом"
      },
      {
        "code": "16",
        "name": "тойром, цөөрөм"
      },
      {
        "code": "05",
        "name": "гатлага"
      },
      {
        "code": "17",
        "name": "тохой"
      },
      {
        "code": "06",
        "name": "гол, харз"
      },
      {
        "code": "18",
        "name": "ус"
      },
      {
        "code": "07",
        "name": "горхи"
      },
      {
        "code": "19",
        "name": "усан сан"
      },
      {
        "code": "08",
        "name": "мөрөн"
      },
      {
        "code": "20",
        "name": "хөвөө"
      },
      {
        "code": "09",
        "name": "нуур"
      },
      {
        "code": "21",
        "name": "худаг"
      },
      {
        "code": "10",
        "name": "рашaan"
      },
      {
        "code": "22",
        "name": "цутгалан, хүрхэрээ, таргил"
      },
      {
        "code": "11",
        "name": "сайр, садарга"
      },
      {
        "code": "23",
        "name": "цүнхэг, цүлхэн, хөв"
      },
      {
        "code": "12",
        "name": "салаа"
      },
      {
        "code": "24",
        "name": "шанд"
      }
    ]
  },
  {
    "code": "05",
    "name": "Зүг чиг, байршил",
    "children": [
      {
        "code": "01",
        "name": "адах"
      },
      {
        "code": "09",
        "name": "дэл"
      },
      {
        "code": "02",
        "name": "ар"
      },
      {
        "code": "10",
        "name": "зааг"
      },
      {
        "code": "03",
        "name": "булан"
      },
      {
        "code": "11",
        "name": "завсар"
      },
      {
        "code": "04",
        "name": "бэлчир"
      },
      {
        "code": "12",
        "name": "зах"
      },
      {
        "code": "05",
        "name": "ганга"
      },
      {
        "code": "13",
        "name": "урт"
      },
      {
        "code": "06",
        "name": "говь"
      },
      {
        "code": "14",
        "name": "уулзвар"
      },
      {
        "code": "07",
        "name": "гүвээ, гүдгэр, гүдэн, гүрдгэр"
      },
      {
        "code": "15",
        "name": "үзүүр"
      },
      {
        "code": "08",
        "name": "дов, довон, довцог"
      },
      {
        "code": "16",
        "name": "хаяа"
      }
    ]
  },
  {
    "code": "06",
    "name": "Уур амьсгал",
    "children": [
      {
        "code": "01",
        "name": "зуслан"
      },
      {
        "code": "02",
        "name": "зэрэглээ"
      },
      {
        "code": "03",
        "name": "уур"
      },
      {
        "code": "04",
        "name": "хур"
      }
    ]
  },
  {
    "code": "07",
    "name": "Тогтоц",
    "children": [
      {
        "code": "01",
        "name": "агуй, хонгил"
      },
      {
        "code": "02",
        "name": "ан, ангал, гануу"
      },
      {
        "code": "03",
        "name": "барзан"
      },
      {
        "code": "04",
        "name": "бүрд"
      },
      {
        "code": "05",
        "name": "гацаа, сүв, мухар"
      },
      {
        "code": "06",
        "name": "гозгор, шовх, шовгор"
      },
      {
        "code": "07",
        "name": "дэнж, дэвсэг, дэв, хавтгай, ширээ"
      },
      {
        "code": "08",
        "name": "жалга, гуу, зуух"
      },
      {
        "code": "09",
        "name": "мөргөцөг, мөргүү, мөрөг, ирмэг, хөмөг"
      },
      {
        "code": "10",
        "name": "овгор, товгор, товог, дүмбэн, оорцог"
      },
      {
        "code": "11",
        "name": "огтрого"
      },
      {
        "code": "12",
        "name": "тал"
      },
      {
        "code": "13",
        "name": "тэнгэр"
      },
      {
        "code": "14",
        "name": "тээг"
      },
      {
        "code": "15",
        "name": "хад, цохио, цонж"
      },
      {
        "code": "16",
        "name": "ханан"
      },
      {
        "code": "17",
        "name": "ховол"
      },
      {
        "code": "18",
        "name": "хонд"
      },
      {
        "code": "19",
        "name": "хонхор, хонх, хунхуй"
      },
      {
        "code": "20",
        "name": "хоолой"
      },
      {
        "code": "21",
        "name": "хорголж"
      },
      {
        "code": "22",
        "name": "хотгор, хотос"
      },
      {
        "code": "23",
        "name": "хошуу"
      },
      {
        "code": "24",
        "name": "хөдөө"
      },
      {
        "code": "25",
        "name": "хөндий"
      },
      {
        "code": "26",
        "name": "хөтөл"
      },
      {
        "code": "27",
        "name": "хургад"
      },
      {
        "code": "28",
        "name": "нүүр, хуруу, шанаа, дух, магнай, сээр, хажуу, сүвээ, хавирга, хөл, сүүл, гуя, тархи"
      },
      {
        "code": "29",
        "name": "хуудс"
      },
      {
        "code": "30",
        "name": "хүрэм"
      },
      {
        "code": "31",
        "name": "хүрээ"
      },
      {
        "code": "32",
        "name": "цоорхой"
      },
      {
        "code": "33",
        "name": "эрэг, эрэгцэг"
      }
    ]
  }
]

counter = 1
def create_pid(major_class, minor_class):

  global counter  # Access the global counter variable
  
  # Find the major class code
  major_code = next((item['code'] for item in data_dict if item['name'] == major_class), None)
  
  # Find the minor class code
  minor_code = None
  for item in data_dict:
      if item['name'] == major_class:
          minor_code = next((child['code'] for child in item['children'] if child['name'] == minor_class), None)
          break
  
  # Format the sequence number and increment the counter
  seq_str = str(counter).zfill(5)
  counter += 1  # Increment the counter for the next record
  
  # Construct the pid
  if major_code and minor_code:
      return f"B{major_code}{minor_code}{seq_str}"
  return None

# Step 4: Use the function to fill the pid in the Field Calculator
# Example usage in the field calculator expression:
create_pid(!majorClass!, !minorClass!)